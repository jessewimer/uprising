{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uprising Seeds - Germination / Inventory</title>

    <!-- base -->
    <link rel="stylesheet" href="{% static 'office/css/base.css' %}">
    <link rel="stylesheet" href="{% static 'office/css/germination_inventory.css' %}">

</head>

<body>
    <div class="container">
        <!-- Header Section -->
        <div class="header">
            <div class="header-top">
                <div class="header-left">
                    <a href="{% url 'office_landing' %}" class="back-button">
                        ‚Üê Dashboard
                    </a>
                    <h1 class="page-title">Germination / Inventory</h1>
                </div>

                <div class="header-right">
                    <div class="filter-group">
                        <label class="filter-label">Category:</label>
                        <select class="filter-select" id="categoryFilter">
                            <option value="">All Categories</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label class="filter-label">Group:</label>
                        <select class="filter-select" id="groupFilter">
                            <option value="">All Groups</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label class="filter-label">Veg Type:</label>
                        <select class="filter-select" id="vegTypeFilter">
                            <option value="">All Veg Types</option>
                        </select>
                    </div>

                    <button class="clear-filters" id="clearFiltersBtn">
                        Clear Filters
                    </button>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="content">
            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr id="tableHeader">
                            <th>Variety</th>
                            <th>Lot</th>
                            <th>Current Inv</th>
                            <th>Previous Inv</th>
                            <th>Difference</th>
                            <!-- Germination columns will be added dynamically -->
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- Data will be populated here -->
                    </tbody>
                </table>
                
                <!-- Loading State -->
                <div class="loading-state" id="loadingState">
                    <div class="loading-spinner"></div>
                    <div>Loading germination and inventory data...</div>
                </div>

                <!-- Empty State -->
                <div class="empty-state" id="emptyState" style="display: none;">
                    <div class="empty-state-icon">üìä</div>
                    <div class="empty-state-text">No data found</div>
                    <div class="empty-state-subtext">Try adjusting your filters or check that data has been entered</div>
                </div>
            </div>
        </div>
    </div>

    <!-- CSRF Token -->
    {% csrf_token %}

    <!-- Print Confirmation Modal -->
    <div class="modal" id="printModal">
        <div class="modal-content">
            <div class="modal-icon" id="modalIcon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6,9 6,2 18,2 18,9"></polyline>
                    <path d="M6,18H4a2,2,0,0,1-2-2V11a2,2,0,0,1,2-2H20a2,2,0,0,1,2,2v5a2,2,0,0,1-2,2H18"></path>
                    <polyline points="6,14 18,14 18,22 6,22 6,14"></polyline>
                </svg>
            </div>
            <h3 class="modal-title" id="modalTitle">Print Germination Label</h3>
            <div class="modal-message">
                <div id="modalText">Are you sure you want to print a germination sample label for:</div>
                <div class="modal-variety" id="modalVariety">Loading...</div>
                <div id="modalExtraText" style="display: none;">Do you wish to print another label?</div>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn secondary" id="modalCancel">Cancel</button>
                <button class="modal-btn primary" id="modalConfirm">Print Label</button>
            </div>
        </div>
    </div>

    <!-- Bulk Confirmation Modal -->
    <div class="modal" id="bulkModal">
        <div class="modal-content">
            <div class="modal-icon bulk-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M20 7h-9"></path>
                    <path d="M14 17H5"></path>
                    <circle cx="17" cy="17" r="3"></circle>
                    <circle cx="7" cy="7" r="3"></circle>
                </svg>
            </div>
            <h3 class="modal-title">Confirm Bulk Stock on Website</h3>
            <div class="modal-message">
                <div>Are you sure you want to mark bulk stock as available on the website for:</div>
                <div class="modal-variety" id="bulkModalVariety">Loading...</div>
            </div>
            <div class="modal-buttons">
                <button class="modal-btn secondary" id="bulkModalCancel">Cancel</button>
                <button class="modal-btn primary" id="bulkModalConfirm">Confirm</button>
            </div>
        </div>
    </div>

    <!-- Sales Modal -->
    <div class="sales-modal" id="salesModal">
        <div class="sales-modal-content">
            <button class="sales-modal-close" id="salesModalClose">&times;</button>
            <h2 class="sales-modal-title" id="salesModalTitle">Sales Data</h2>
            
            <div id="salesContent">
                <div class="sales-loading" id="salesLoading">
                    <div class="sales-loading-spinner"></div>
                    <div>Loading sales data...</div>
                </div>
                
                <table class="sales-data-table" id="salesTable" style="display: none;">
                    <thead>
                        <tr>
                            <th>Product SKU</th>
                            <th id="quantityHeader">Quantity Sold</th>
                        </tr>
                    </thead>
                    <tbody id="salesTableBody"></tbody>
                </table>
                
                <div class="sales-empty" id="salesEmpty" style="display: none;">
                    <div class="sales-empty-icon">üìä</div>
                    <div>No sales data found for this variety</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Pass Django URLs to JavaScript
        window.appUrls = {
            germinationInventoryData: "{% url 'germination_inventory_data' %}",
            createGermSamplePrint: "{% url 'create_germ_sample_print' %}",
            varietySalesData: "{% url 'variety_sales_data' sku_prefix='PLACEHOLDER' %}",
            updateWebsiteBulk: "{% url 'update_website_bulk' %}"
        };
    </script>

    <!-- Load external JS -->
    <script src="{% static 'office/js/germination_inventory.js' %}"></script>
</body>
</html>